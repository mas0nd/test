<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîç Local Storage Enumeration Tool</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            border: 2px solid #00ff00;
            padding: 20px;
            border-radius: 8px;
            background: #001a00;
        }
        
        .section {
            background: #1a1a1a;
            border: 2px solid #333;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
        }
        
        .critical { 
            border-color: #ff0000; 
            background: #1a0000; 
        }
        
        .success { 
            border-color: #00ff00; 
            background: #001a00; 
        }
        
        button {
            background: #2d5a27;
            color: #00ff00;
            border: 2px solid #00ff00;
            padding: 12px 20px;
            margin: 8px 5px;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            border-radius: 5px;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        button:hover {
            background: #00ff00;
            color: #000;
        }
        
        .critical-btn {
            background: #5a1a1a;
            border-color: #ff0000;
            color: #ff6b6b;
        }
        
        .critical-btn:hover {
            background: #ff0000;
            color: #fff;
        }
        
        .storage-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #444;
            border-radius: 5px;
            background: #2a2a2a;
        }
        
        .storage-title {
            font-size: 18px;
            font-weight: bold;
            color: #4dabf7;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #444;
        }
        
        .storage-item {
            background: #000;
            border: 1px solid #333;
            padding: 10px;
            margin: 5px 0;
            border-radius: 3px;
        }
        
        .storage-key {
            color: #ffaa00;
            font-weight: bold;
            word-break: break-all;
        }
        
        .storage-value {
            color: #00ff00;
            margin-top: 5px;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 200px;
            overflow-y: auto;
            font-size: 12px;
        }
        
        .storage-meta {
            color: #888;
            font-size: 11px;
            margin-top: 5px;
        }
        
        .summary-stats {
            display: flex;
            justify-content: space-around;
            background: #2a2a2a;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            text-align: center;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #ff6b6b;
        }
        
        .stat-label {
            font-size: 12px;
            color: #888;
        }
        
        .no-data {
            color: #888;
            font-style: italic;
            text-align: center;
            padding: 20px;
        }
        
        .error {
            color: #ff6b6b;
            background: #2a0000;
            padding: 10px;
            border-radius: 3px;
            margin: 10px 0;
        }
        
        .success-msg {
            color: #00ff00;
            background: #002a00;
            padding: 10px;
            border-radius: 3px;
            margin: 10px 0;
        }
        
        .json-container {
            background: #000;
            border: 1px solid #333;
            border-radius: 3px;
            padding: 10px;
            margin: 10px 0;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .export-section {
            margin: 20px 0;
            padding: 15px;
            background: #2a2a2a;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç Local Storage Enumeration Tool</h1>
            <p>Comprehensive browser storage enumeration and content extraction</p>
        </div>

        <div class="section">
            <h2>üöÄ Storage Enumeration Controls</h2>
            <button class="critical-btn" onclick="enumerateAllStorage()">üîç Enumerate All Storage</button>
            <button onclick="clearResults()">üóëÔ∏è Clear Results</button>
            <button onclick="exportResults()">üìÅ Export Results</button>
        </div>

        <div id="results-container">
            <!-- Results will be populated here -->
        </div>

        <div class="section success">
            <h2>üìä Summary Statistics</h2>
            <div class="summary-stats">
                <div>
                    <div class="stat-number" id="total-items">0</div>
                    <div class="stat-label">Total Items</div>
                </div>
                <div>
                    <div class="stat-number" id="storage-types">0</div>
                    <div class="stat-label">Storage Types</div>
                </div>
                <div>
                    <div class="stat-number" id="total-size">0</div>
                    <div class="stat-label">Total Size (KB)</div>
                </div>
                <div>
                    <div class="stat-number" id="accessible-storages">0</div>
                    <div class="stat-label">Accessible</div>
                </div>
            </div>
        </div>

        <div class="export-section">
            <h3>üìã Export Options</h3>
            <button onclick="copyToClipboard()">üìã Copy to Clipboard</button>
            <button onclick="downloadAsJSON()">üíæ Download JSON</button>
            <button onclick="downloadAsCSV()">üìÑ Download CSV</button>
        </div>
    </div>

    <script>
        let storageData = {};
        let totalItems = 0;
        let totalSize = 0;
        let accessibleStorages = 0;

        function enumerateAllStorage() {
            console.log('üîç Starting comprehensive storage enumeration...');
            
            // Clear previous results
            document.getElementById('results-container').innerHTML = '';
            storageData = {};
            totalItems = 0;
            totalSize = 0;
            accessibleStorages = 0;

            // Test localStorage
            enumerateLocalStorage();
            
            // Test sessionStorage
            enumerateSessionStorage();
            
            // Test IndexedDB
            enumerateIndexedDB();
            
            // Test Cookies
            enumerateCookies();
            
            // Test WebSQL (if available)
            enumerateWebSQL();
            
            // Test Cache API
            enumerateCacheAPI();

            // Update summary
            updateSummary();
        }

        function enumerateLocalStorage() {
            const container = document.getElementById('results-container');
            const section = document.createElement('div');
            section.className = 'storage-section';
            
            try {
                const title = document.createElement('div');
                title.className = 'storage-title';
                title.textContent = 'üóÑÔ∏è localStorage';
                section.appendChild(title);

                if (typeof Storage !== 'undefined' && localStorage) {
                    const keys = Object.keys(localStorage);
                    
                    if (keys.length > 0) {
                        storageData.localStorage = {};
                        
                        keys.forEach(key => {
                            const value = localStorage.getItem(key);
                            storageData.localStorage[key] = value;
                            
                            const item = document.createElement('div');
                            item.className = 'storage-item';
                            
                            const keyDiv = document.createElement('div');
                            keyDiv.className = 'storage-key';
                            keyDiv.textContent = `Key: ${key}`;
                            
                            const valueDiv = document.createElement('div');
                            valueDiv.className = 'storage-value';
                            valueDiv.textContent = value;
                            
                            const metaDiv = document.createElement('div');
                            metaDiv.className = 'storage-meta';
                            metaDiv.textContent = `Size: ${value ? value.length : 0} characters | Type: ${typeof value}`;
                            
                            item.appendChild(keyDiv);
                            item.appendChild(valueDiv);
                            item.appendChild(metaDiv);
                            section.appendChild(item);
                            
                            totalItems++;
                            totalSize += value ? value.length : 0;
                        });
                        
                        const successMsg = document.createElement('div');
                        successMsg.className = 'success-msg';
                        successMsg.textContent = `‚úÖ localStorage accessible - Found ${keys.length} items`;
                        section.appendChild(successMsg);
                        
                        accessibleStorages++;
                    } else {
                        const noData = document.createElement('div');
                        noData.className = 'no-data';
                        noData.textContent = 'No localStorage data found';
                        section.appendChild(noData);
                    }
                } else {
                    const error = document.createElement('div');
                    error.className = 'error';
                    error.textContent = '‚ùå localStorage not available';
                    section.appendChild(error);
                }
            } catch (e) {
                const error = document.createElement('div');
                error.className = 'error';
                error.textContent = `‚ùå localStorage access error: ${e.message}`;
                section.appendChild(error);
            }
            
            container.appendChild(section);
        }

        function enumerateSessionStorage() {
            const container = document.getElementById('results-container');
            const section = document.createElement('div');
            section.className = 'storage-section';
            
            try {
                const title = document.createElement('div');
                title.className = 'storage-title';
                title.textContent = 'üìã sessionStorage';
                section.appendChild(title);

                if (typeof Storage !== 'undefined' && sessionStorage) {
                    const keys = Object.keys(sessionStorage);
                    
                    if (keys.length > 0) {
                        storageData.sessionStorage = {};
                        
                        keys.forEach(key => {
                            const value = sessionStorage.getItem(key);
                            storageData.sessionStorage[key] = value;
                            
                            const item = document.createElement('div');
                            item.className = 'storage-item';
                            
                            const keyDiv = document.createElement('div');
                            keyDiv.className = 'storage-key';
                            keyDiv.textContent = `Key: ${key}`;
                            
                            const valueDiv = document.createElement('div');
                            valueDiv.className = 'storage-value';
                            valueDiv.textContent = value;
                            
                            const metaDiv = document.createElement('div');
                            metaDiv.className = 'storage-meta';
                            metaDiv.textContent = `Size: ${value ? value.length : 0} characters | Type: ${typeof value}`;
                            
                            item.appendChild(keyDiv);
                            item.appendChild(valueDiv);
                            item.appendChild(metaDiv);
                            section.appendChild(item);
                            
                            totalItems++;
                            totalSize += value ? value.length : 0;
                        });
                        
                        const successMsg = document.createElement('div');
                        successMsg.className = 'success-msg';
                        successMsg.textContent = `‚úÖ sessionStorage accessible - Found ${keys.length} items`;
                        section.appendChild(successMsg);
                        
                        accessibleStorages++;
                    } else {
                        const noData = document.createElement('div');
                        noData.className = 'no-data';
                        noData.textContent = 'No sessionStorage data found';
                        section.appendChild(noData);
                    }
                } else {
                    const error = document.createElement('div');
                    error.className = 'error';
                    error.textContent = '‚ùå sessionStorage not available';
                    section.appendChild(error);
                }
            } catch (e) {
                const error = document.createElement('div');
                error.className = 'error';
                error.textContent = `‚ùå sessionStorage access error: ${e.message}`;
                section.appendChild(error);
            }
            
            container.appendChild(section);
        }

        function enumerateIndexedDB() {
            const container = document.getElementById('results-container');
            const section = document.createElement('div');
            section.className = 'storage-section';
            
            const title = document.createElement('div');
            title.className = 'storage-title';
            title.textContent = 'üíæ IndexedDB';
            section.appendChild(title);

            try {
                if (!window.indexedDB) {
                    const error = document.createElement('div');
                    error.className = 'error';
                    error.textContent = '‚ùå IndexedDB not available';
                    section.appendChild(error);
                    container.appendChild(section);
                    return;
                }

                // Try to enumerate databases
                if (indexedDB.databases) {
                    indexedDB.databases().then(databases => {
                        if (databases.length > 0) {
                            storageData.indexedDB = { databases: [] };
                            
                            databases.forEach(db => {
                                const dbInfo = {
                                    name: db.name,
                                    version: db.version
                                };
                                storageData.indexedDB.databases.push(dbInfo);
                                
                                const item = document.createElement('div');
                                item.className = 'storage-item';
                                
                                const keyDiv = document.createElement('div');
                                keyDiv.className = 'storage-key';
                                keyDiv.textContent = `Database: ${db.name}`;
                                
                                const valueDiv = document.createElement('div');
                                valueDiv.className = 'storage-value';
                                valueDiv.textContent = `Version: ${db.version}`;
                                
                                item.appendChild(keyDiv);
                                item.appendChild(valueDiv);
                                section.appendChild(item);
                                
                                totalItems++;
                            });
                            
                            const successMsg = document.createElement('div');
                            successMsg.className = 'success-msg';
                            successMsg.textContent = `‚úÖ IndexedDB accessible - Found ${databases.length} databases`;
                            section.appendChild(successMsg);
                            
                            accessibleStorages++;
                        } else {
                            const noData = document.createElement('div');
                            noData.className = 'no-data';
                            noData.textContent = 'No IndexedDB databases found';
                            section.appendChild(noData);
                        }
                        updateSummary();
                    }).catch(error => {
                        const errorDiv = document.createElement('div');
                        errorDiv.className = 'error';
                        errorDiv.textContent = `‚ùå IndexedDB enumeration error: ${error.message}`;
                        section.appendChild(errorDiv);
                    });
                } else {
                    const noData = document.createElement('div');
                    noData.className = 'no-data';
                    noData.textContent = 'IndexedDB.databases() not available - cannot enumerate';
                    section.appendChild(noData);
                }
            } catch (e) {
                const error = document.createElement('div');
                error.className = 'error';
                error.textContent = `‚ùå IndexedDB access error: ${e.message}`;
                section.appendChild(error);
            }
            
            container.appendChild(section);
        }

        function enumerateCookies() {
            const container = document.getElementById('results-container');
            const section = document.createElement('div');
            section.className = 'storage-section';
            
            const title = document.createElement('div');
            title.className = 'storage-title';
            title.textContent = 'üç™ Cookies';
            section.appendChild(title);

            try {
                const cookies = document.cookie;
                
                if (cookies && cookies.length > 0) {
                    const cookieArray = cookies.split(';').map(cookie => cookie.trim());
                    storageData.cookies = {};
                    
                    cookieArray.forEach(cookie => {
                        if (cookie) {
                            const [name, ...valueParts] = cookie.split('=');
                            const value = valueParts.join('=');
                            
                            storageData.cookies[name] = value;
                            
                            const item = document.createElement('div');
                            item.className = 'storage-item';
                            
                            const keyDiv = document.createElement('div');
                            keyDiv.className = 'storage-key';
                            keyDiv.textContent = `Cookie: ${name}`;
                            
                            const valueDiv = document.createElement('div');
                            valueDiv.className = 'storage-value';
                            valueDiv.textContent = value || '(empty)';
                            
                            const metaDiv = document.createElement('div');
                            metaDiv.className = 'storage-meta';
                            metaDiv.textContent = `Size: ${cookie.length} characters`;
                            
                            item.appendChild(keyDiv);
                            item.appendChild(valueDiv);
                            item.appendChild(metaDiv);
                            section.appendChild(item);
                            
                            totalItems++;
                            totalSize += cookie.length;
                        }
                    });
                    
                    const successMsg = document.createElement('div');
                    successMsg.className = 'success-msg';
                    successMsg.textContent = `‚úÖ Cookies accessible - Found ${cookieArray.length} cookies`;
                    section.appendChild(successMsg);
                    
                    accessibleStorages++;
                } else {
                    const noData = document.createElement('div');
                    noData.className = 'no-data';
                    noData.textContent = 'No cookies found';
                    section.appendChild(noData);
                }
            } catch (e) {
                const error = document.createElement('div');
                error.className = 'error';
                error.textContent = `‚ùå Cookie access error: ${e.message}`;
                section.appendChild(error);
            }
            
            container.appendChild(section);
        }

        function enumerateWebSQL() {
            const container = document.getElementById('results-container');
            const section = document.createElement('div');
            section.className = 'storage-section';
            
            const title = document.createElement('div');
            title.className = 'storage-title';
            title.textContent = 'üóÉÔ∏è WebSQL (Legacy)';
            section.appendChild(title);

            try {
                if (window.openDatabase) {
                    const noData = document.createElement('div');
                    noData.className = 'no-data';
                    noData.textContent = 'WebSQL available but deprecated - enumeration skipped';
                    section.appendChild(noData);
                } else {
                    const error = document.createElement('div');
                    error.className = 'error';
                    error.textContent = '‚ùå WebSQL not available';
                    section.appendChild(error);
                }
            } catch (e) {
                const error = document.createElement('div');
                error.className = 'error';
                error.textContent = `‚ùå WebSQL access error: ${e.message}`;
                section.appendChild(error);
            }
            
            container.appendChild(section);
        }

        function enumerateCacheAPI() {
            const container = document.getElementById('results-container');
            const section = document.createElement('div');
            section.className = 'storage-section';
            
            const title = document.createElement('div');
            title.className = 'storage-title';
            title.textContent = 'üóÇÔ∏è Cache API';
            section.appendChild(title);

            try {
                if ('caches' in window) {
                    caches.keys().then(cacheNames => {
                        if (cacheNames.length > 0) {
                            storageData.cacheAPI = { caches: cacheNames };
                            
                            cacheNames.forEach(cacheName => {
                                const item = document.createElement('div');
                                item.className = 'storage-item';
                                
                                const keyDiv = document.createElement('div');
                                keyDiv.className = 'storage-key';
                                keyDiv.textContent = `Cache: ${cacheName}`;
                                
                                item.appendChild(keyDiv);
                                section.appendChild(item);
                                
                                totalItems++;
                            });
                            
                            const successMsg = document.createElement('div');
                            successMsg.className = 'success-msg';
                            successMsg.textContent = `‚úÖ Cache API accessible - Found ${cacheNames.length} caches`;
                            section.appendChild(successMsg);
                            
                            accessibleStorages++;
                        } else {
                            const noData = document.createElement('div');
                            noData.className = 'no-data';
                            noData.textContent = 'No caches found';
                            section.appendChild(noData);
                        }
                        updateSummary();
                    }).catch(error => {
                        const errorDiv = document.createElement('div');
                        errorDiv.className = 'error';
                        errorDiv.textContent = `‚ùå Cache API error: ${error.message}`;
                        section.appendChild(errorDiv);
                    });
                } else {
                    const error = document.createElement('div');
                    error.className = 'error';
                    error.textContent = '‚ùå Cache API not available';
                    section.appendChild(error);
                }
            } catch (e) {
                const error = document.createElement('div');
                error.className = 'error';
                error.textContent = `‚ùå Cache API access error: ${e.message}`;
                section.appendChild(error);
            }
            
            container.appendChild(section);
        }

        function updateSummary() {
            document.getElementById('total-items').textContent = totalItems;
            document.getElementById('storage-types').textContent = Object.keys(storageData).length;
            document.getElementById('total-size').textContent = Math.round(totalSize / 1024 * 100) / 100;
            document.getElementById('accessible-storages').textContent = accessibleStorages;
        }

        function clearResults() {
            document.getElementById('results-container').innerHTML = '';
            storageData = {};
            totalItems = 0;
            totalSize = 0;
            accessibleStorages = 0;
            updateSummary();
        }

        function exportResults() {
            const exportData = {
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent,
                domain: window.location.hostname,
                summary: {
                    totalItems: totalItems,
                    storageTypes: Object.keys(storageData).length,
                    totalSizeKB: Math.round(totalSize / 1024 * 100) / 100,
                    accessibleStorages: accessibleStorages
                },
                storageData: storageData
            };
            
            console.log('Storage enumeration results:', exportData);
            return exportData;
        }

        function copyToClipboard() {
            const data = JSON.stringify(exportResults(), null, 2);
            navigator.clipboard.writeText(data).then(() => {
                alert('Results copied to clipboard!');
            }).catch(err => {
                console.error('Copy failed:', err);
                alert('Copy failed - check console for data');
            });
        }

        function downloadAsJSON() {
            const data = JSON.stringify(exportResults(), null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `storage_enumeration_${Date.now()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function downloadAsCSV() {
            let csv = 'Storage Type,Key,Value,Size\n';
            
            Object.entries(storageData).forEach(([storageType, data]) => {
                if (typeof data === 'object' && data !== null) {
                    Object.entries(data).forEach(([key, value]) => {
                        const escapedValue = String(value).replace(/"/g, '""');
                        csv += `"${storageType}","${key}","${escapedValue}","${String(value).length}"\n`;
                    });
                }
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `storage_enumeration_${Date.now()}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Auto-run on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üîç Local Storage Enumeration Tool loaded');
            console.log('Click "Enumerate All Storage" to begin analysis');
        });
    </script>
</body>
</html>
